#!/usr/bin/env node
var path      = require('path');
var fs        = require('fs');
var minimist  = require('minimist');
var xcss      = require('../index');
var compile   = require('../compiler');

var argv = minimist(process.argv, {boolean: ['c', 'compile', 'h', 'help']});

if (argv.help|| argv.h) {
  usage();
  process.exit(0);
}

var file = argv._[2];

if (!file || !fs.existsSync(file)) {
  usage();
  error('provide a filename as an argument');
  process.exit(1);
}

file = path.resolve(file);

if (argv.compile || argv.c) {
  console.log(compile(fs.readFileSync(file, 'utf8')));
} else {
  console.log(require(file).toString());
}

function usage() {
  console.log(fs.readFileSync(path.join(__dirname, 'usage.txt'), 'utf8'));
}

function error(msg) {
  console.warn('error:', msg);
}
